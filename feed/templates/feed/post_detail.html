{% extends 'base.html' %}

{% block content %}
<style>
  .custom-card {
    max-width: 600px; /* ì¹´ë“œì˜ ìµœëŒ€ ë„ˆë¹„ ì„¤ì • */
    margin: auto; /* ê°€ìš´ë° ì •ë ¬ */
  }
  .feed-image {
    object-fit: cover; /* ì´ë¯¸ì§€ ë¹„ìœ¨ ìœ ì§€í•˜ë©´ì„œ ë®ê¸° */
    max-height: 500px; /* ì´ë¯¸ì§€ì˜ ìµœëŒ€ ë†’ì´ ì„¤ì • */
  }
  .carousel-item {
    transition: transform 1s ease, opacity 0.5s ease; 
  }
  /* ì¢‹ì•„ìš” ë§í¬ì— ëŒ€í•œ ë°‘ì¤„ ì œê±° */
  .no-underline {
    text-decoration: none; /* ë°‘ì¤„ ì—†ì• ê¸° */
  }
  
</style>
<div class="container mt-5">
    <div class="card custom-card">

      <div class="card-body">
        {% if post.feed_images.all %}
          <div id="carouselExampleControls" class="carousel slide" data-bs-interval="false">
            <div class="carousel-inner">
              {% for image in post.feed_images.all %}
                <div class="carousel-item {% if forloop.first %}active{% endif %}">
                  <img src="{{ image.image.url }}" class="d-block w-100 feed-image" alt="...">
                </div>
              {% endfor %}
            </div>
            <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleControls" data-bs-slide="prev">
              <span class="carousel-control-prev-icon" aria-hidden="true"></span>
              <span class="visually-hidden">Previous</span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleControls" data-bs-slide="next">
              <span class="carousel-control-next-icon" aria-hidden="true"></span>
              <span class="visually-hidden">Next</span>
            </button>
          </div>
        {% endif %}
        
        <h2>{{ post.user.username }}</h2>

        <h2>{{ post.title }}</h2>
        <p class="mt-3">{{ post.body_text }}</p>

        <!-- ì¢‹ì•„ìš” ë²„íŠ¼ ë“± ì¶”ê°€ ê¸°ëŠ¥ êµ¬í˜„ -->
        {% if user in post.likes.all %}
          <a href="{% url 'feed:like_content' post.id %}" class="no-underline">â¤ï¸</a> <!-- ì¢‹ì•„ìš”ë¥¼ ëˆŒë €ì„ ë•Œ -->
        {% else %}
          <a href="{% url 'feed:like_content' post.id %}" class="no-underline">ğŸ¤</a> <!-- ì¢‹ì•„ìš”ë¥¼ ëˆ„ë¥´ì§€ ì•Šì•˜ì„ ë•Œ -->
        {% endif %}
        : {{ post.likes.count }}


        
        {% if post.content_type == 'review' and post.product %}
          <hr>
          <h5>ì œí’ˆ ë¦¬ë·°</h5>
          <p>ì œí’ˆëª…: {{ post.product.name }}</p>
          <p>íŒë§¤ì: {{ post.seller.username }}</p>
        {% endif %}
      </div>
      <div class="card-footer text-muted">
        <p> {{ post.created_at|date:"Y-m-d H:i" }} </p>
      </div>
      <!-- ----------------- ì¶”ê°€------------------------------  -->
    {% for comment in post.comment_set.all %}   <!-- Contentì˜ í‚¤ê°’postë¥¼ ì°¸ì¡°ë°›ê³ ìˆëŠ” commentì„ _set ê°ì²´ ë‹¤ê°€ì§€ê³ ì˜´ -->
                <div>
                    <p>{{ comment.comment_text }}</p>
                    <p>ì‘ì„±ì: {{ comment.user.username }}</p>
                    <p>ì‘ì„±ì¼ì‹œ: {{ comment.created_at }}</p>
                    <!-- ê´€ë¦¬ì í˜¹ì€ ëŒ“ê¸€ì‘ì„±ì ë³¸ì¸ë§Œ ëŒ“ê¸€ ì‚­ì œê°€ëŠ¥ -->
                    {% if request.user == comment.user or request.user.is_staff %}
                        <form action="{% url 'feed:comments_delete' comment.pk %}" method="post">
                        {% csrf_token %}
                        <button type="submit">ì‚­ì œ</button>
                        </form>
                    {% endif %}
                    
                </div>
            {% empty %}
                <p>ëŒ“ê¸€ì´ ì—†ìŠµë‹ˆë‹¤.</p>
            {% endfor %}
      <form action="{% url 'feed:comments_create' post.id %}" method="post">
        {% csrf_token %}
        {{ commentform }}
        <button type="submit">ì‘ì„±</button>
    </form>
    <!------------------------------------------------- -->
    </div>
</div>
{% endblock %}